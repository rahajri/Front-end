<div class="page-wrapper board-screen">
  <div class="content container-fluid">
    <div class="acc-content">
      <div class="row">
        <div class="col-sm-12">
          <div class="multistep-form">
            <!-- Freelancer Multistep -->
            <div class="multistep-progress" id="freelance_step">
              <div class="container">
                <div class="first-progress">
                  <div class="row align-items-center">
                    <div class="col-md-3">
                      <div class="board-logo">
                        <a [routerLink]="routes.home"
                          ><img
                            src="assets/img/logo.svg"
                            alt="Img"
                            class="img-fluid"
                        /></a>
                      </div>
                    </div>
                    <div class="col-md-9">
                      <ul id="progressbar" class="progressbar">
                        <li
                          [ngClass]="{
                            'progress-active': selectedFieldSet[0] === 1,
                            'progress-activated': selectedFieldSet[0] > 1
                          }"
                        >
                          <div class="multi-step">
                            <img
                              src="assets/img/icon/wizard-icon-02.svg"
                              alt="Img"
                            />
                          </div>
                          <div class="steps-count">
                            <span>Step 1/3</span>
                            <h5>Personal info</h5>
                          </div>
                        </li>
                        <li
                          [ngClass]="{
                            'progress-active': selectedFieldSet[0] === 2,
                            'progress-activated': selectedFieldSet[0] > 2
                          }"
                        >
                          <div class="multi-step">
                            <img
                              src="assets/img/icon/wizard-icon-03.svg"
                              alt="Img"
                            />
                          </div>
                          <div class="steps-count">
                            <span>Step 2/3</span>
                            <h5>Skills & Experience</h5>
                          </div>
                        </li>

                        <li
                          [ngClass]="{
                            'progress-active': selectedFieldSet[0] === 3,
                            'progress-activated': selectedFieldSet[0] > 3
                          }"
                        >
                          <div class="multi-step">
                            <img
                              src="assets/img/icon/wizard-icon-05.svg"
                              alt="Img"
                            />
                          </div>
                          <div class="steps-count">
                            <span>Step 3/3</span>
                            <h5>Email Verification</h5>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Personal Info -->
            <div
              class="on-board field-card select-account select-btn"
              [class.d-block]="selectedFieldSet[0] === 1"
            >
              <div class="text-center onboard-head">
                <h2>{{ "personalDetails.title" | translate }}</h2>

                <p>
                  {{ "personalDetails.description" | translate }}
                </p>
                <span
                  *ngIf="spinner"
                  class="spinner-border spinner-border-sm me-2"
                  role="status"
                ></span>
              </div>

              <div class="field-item personal-info space-info">
                <form [formGroup]="form">
                  <div class="row" formGroupName="personalDetails">
                    <div class="col-md-12 col-lg-12">
                      <div class="pro-form-img">
                        <div class="upload-files">
                          <label class="file-upload image-upbtn">
                            <i class="feather icon-upload me-2"></i>Upload CV
                            <input
                              type="file"
                              (change)="onFileSelected($event)"
                              accept=".pdf, image/*"
                            />
                          </label>
                          <span
                            >For better preview recommended size is 450px x
                            450px. Max size 5mb.</span
                          >
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-6">
                      <div class="input-block">
                        <label for="first-name" class="form-label"
                          >First Name</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          formControlName="firstName"
                        />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-6">
                      <div class="input-block">
                        <label for="last-name" class="form-label"
                          >Last Name</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          formControlName="lastName"
                        />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-6">
                      <div class="input-block">
                        <label for="phone-number" class="form-label"
                          >Phone Number</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          formControlName="phoneNumber"
                        />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-6">
                      <div class="input-block">
                        <label for="email-address" class="form-label"
                          >Email Address</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          formControlName="emailAddress"
                          readonly
                        />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="input-block">
                        <label for="date-of-birth" class="form-label"
                          >Date of Birth</label
                        >
                        <div class="cal-icon">
                          <input
                            type="text"
                            class="form-control datetimepicker"
                            bsDatepicker
                            placeholder="Choose"
                            formControlName="birthday"
                          />
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="input-block">
                        <label for="job-title" class="form-label"
                          >Your Job Title</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          formControlName="jobTitle"
                        />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="input-block">
                        <label for="jobs" class="form-label">Type of Job</label>
                        <select
                          [(ngModel)]="selectedValue1"
                          [ngModelOptions]="{ standalone: true }"
                          class="form-control form-select"
                          placeholder="Select"
                        >
                          @for (data of selectedList6; track data) {
                          <option [value]="data.value">
                            {{ data.value }}
                          </option>
                          }
                        </select>
                      </div>
                    </div>
                  </div>
                  <hr />
                  <div class="media-set">
                    <form [formGroup]="locationForm">
                      <div class="row">
                        <div class="col-md-3">
                          <div class="input-block">
                            <label for="post-code" class="form-label"
                              >ZIP / Post Code</label
                            >
                            <input
                              type="text"
                              class="form-control  "
                              formControlName="postalCode"
                              (change)="onZipCodeChange($event)"
                               
                            >
                             
                          </div>
                        </div>

                        <div class="col-md-3">
                          <div class="input-block">
                            <label for="city" class="form-label">City</label>
                            <select
                              class="form-control form-select"
                              formControlName="city"
                              (change)="onCityChange($event)"
                              [disabled]="!cities.length"
                            >
                              <option *ngFor="let city of cities" [value]="city.name">
                                {{ city.name }}
                              </option>
                            </select>
                          </div>
                        </div>

                        <div class="col-md-3">
                          <div class="input-block">
                            <label for="department" class="form-label"
                              >Department</label
                            >
                            <input
                              type="text"
                              class="form-control"
                              formControlName="department"
                              readonly
                            />
                          </div>
                        </div>

                        <div class="col-md-3">
                          <div class="input-block">
                            <label for="region" class="form-label"
                              >Region</label
                            >
                            <input
                              type="text"
                              class="form-control"
                              formControlName="region"
                              readonly
                            />
                          </div>
                        </div>
                      </div>

                      <div class="row">
                        <div class="col-md-12">
                          <div class="input-block">
                            <label for="website-url" class="form-label"
                              >Adresse</label
                            >
                            <input
                              type="text"
                              class="form-control"
                              formControlName="adresse"
                            />
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                </form>
              </div>
              <div class="text-center">
                <input
                  class="btn next_btn btn-primary btn-get btn-next"
                  name="next"
                  type="submit"
                  value="Next"
                  (click)="selectedFieldSet[0] = 2"
                  (keydown.enter)="selectedFieldSet[0] = 2"
                />
              </div>
            </div>
            <!-- /Personal Info -->

            <!-- Skills & Experience -->
            <div
              class="on-board field-card select-account select-btn"
              [class.d-block]="selectedFieldSet[0] === 2"
            >
              <div class="text-center onboard-head">
                <h2>Skills & Experience</h2>
                <p>
                  This is your time to shine. Let potential buyers know what you
                  do best and how you gained your skills, certifications and
                  experience
                </p>
              </div>
              <div class="field-item personal-info space-info">
                <form [formGroup]="form">
                  <div class="row">
                    <div class="col-md-12">
                      <h4>Skills</h4>
                    </div>
                    <div class="row" formArrayName="skills">
                      <!-- Existing Skills List -->
                      <ng-container *ngFor="let skill of skillsArray.controls; let i = index" [formGroupName]="i">
                        <div class="col-md-6">
                          <div class="input-block">
                            <label for="skillName-{{ i }}" class="form-label">Skill</label>
                            <input
                              id="skillName-{{ i }}"
                              formControlName="skillName"
                              class="form-control"
                              placeholder="Enter a skill"
                            />
                          </div>
                        </div>
                
                        <div class="col-md-6">
                          <div class="input-block">
                            <label for="level-{{ i }}" class="focus-label">Level</label>
                            <select
                              formControlName="level"
                              class="form-control form-select"
                              placeholder="Choose Level"
                            >
                              <option *ngFor="let level of skillLevels" [value]="level">{{ level }}</option>
                            </select>
                            <div class="new-addd">
                              <!-- Remove button visible except for the first skill -->
                              <a class="remove_row" (click)="removeSkills(i)" tabindex="0" *ngIf="skillsArray.controls.length > 1">
                                Remove
                              </a>
                
                              <!-- Add New Skill button visible only for the last skill -->
                              <a
                                class="add-new"
                                (click)="addSkillManually()"
                                *ngIf="i === skillsArray.controls.length - 1"
                                tabindex="0"
                              >
                                <i class="feather icon-plus-circle me-1"></i>
                                Add New Skill
                              </a>
                            </div>
                          </div>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </form>
                
                
                  <form [formGroup]="form">
                    <div class="col-md-12">
                      <h4>Métier</h4>
                    </div>
                    <div formArrayName="activities">
                      <div
                        *ngFor="
                          let activity of activities.controls;
                          let i = index
                        "
                        [formGroupName]="i"
                      >
                        <div class="row">
                          <div class="col-md-4">
                            <div class="input-block">
                              <label for="job" class="focus-label"
                                >Métier</label
                              >
                              <select
                                formControlName="job"
                                (change)="onJobChange($event, i)"
                                class="form-control form-select"
                              >
                                <option
                                  *ngFor="let job of jobs"
                                  [value]="job.id"
                                >
                                  {{ job.name }}
                                </option>
                              </select>
                            </div>
                          </div>

                          <div class="col-md-4">
                            <div class="input-block">
                              <label for="sous-activite" class="focus-label"
                                >Sous Activité</label
                              >
                              <input
                                formControlName="sousActivite"
                                type="text"
                                class="form-control"
                                placeholder="Sous Activité"
                                readonly
                              />
                            </div>
                          </div>

                          <div class="col-md-4">
                            <div class="input-block">
                              <label for="activite" class="focus-label"
                                >Activité</label
                              >
                              <input
                                formControlName="activite"
                                type="text"
                                class="form-control"
                                placeholder="Activité"
                                readonly
                              />
                            </div>
                          </div>
                          <div class="new-addd">
                            <a
                              class="add-new"
                              id="activit_add"
                              (click)="addActivity()"
                              tabindex="0"
                            >
                              <i class="feather icon-plus-circle me-1"></i> Add
                              New
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>

                  <form [formGroup]="form">
                    <div class="row" formArrayName="education">
                      <div class="col-md-12">
                        <h4>Education</h4>
                      </div>
                      <div class="row" *ngFor="let education of educationArray.controls; let i = index" [formGroupName]="i">
                        <div class="col-md-6 col-lg-3">
                          <div class="input-block">
                            <label for="degree-name" class="focus-label">Degree Name</label>
                            <input type="text" formControlName="degreeName" class="form-control" />
                          </div>
                        </div>
                    
                        <div class="col-md-6 col-lg-3">
                          <div class="input-block">
                            <label for="university-name" class="focus-label">University Name</label>
                            <input type="text" formControlName="universityName" class="form-control" />
                          </div>
                        </div>
                    
                        <div class="col-md-6 col-lg-3">
                          <div class="input-block">
                            <label for="start-date" class="focus-label">Start Date</label>
                            <div class="cal-icon">
                              <input
                                type="text"
                                formControlName="startDate"
                                class="form-control datetimepicker"
                                placeholder="Choose"
                                bsDatepicker
                                [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' }"
                              />
                            </div>
                          </div>
                        </div>
                    
                        <div class="col-md-6 col-lg-3">
                          <div class="input-block">
                            <label for="end-date" class="focus-label">End Date</label>
                            <div class="cal-icon">
                              <input
                                type="text"
                                formControlName="endDate"
                                class="form-control datetimepicker"
                                placeholder="Choose"
                                bsDatepicker
                                [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' }"
                              />
                            </div>
                    
                            <!-- Add or Remove Button -->
                            <div class="new-addd">
                              <!-- Show 'Add New' button for all except the last entry -->
                              <a
                                *ngIf="i === educationArray.length - 1"
                                class="add-new"
                                (click)="addEducation()"
                                tabindex="0"
                              >
                                <i class="feather icon-plus-circle me-1"></i> Add New
                              </a>
                    
                              <!-- Show 'Remove' button only if there are more than one education entry -->
                              <a
                                *ngIf="educationArray.length > 1"
                                class="remove_row"
                                (click)="removeEducation(i)"
                                tabindex="0"
                              >
                                Remove
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    

                    <div class="row" formArrayName="experiences">
                      <div class="col-md-12">
                        <h4>Experience</h4>
                      </div>
                       
                    
                      <!-- Existing Experience Form Fields (Looping through experiencesArray) -->
                      <div
                        class="row"
                        *ngFor="let experience of experiencesArray.controls; let i = index"
                        [formGroupName]="i"
                      >
                        <div class="col-md-6 col-lg-3">
                          <div class="input-block">
                            <label for="company-name" class="focus-label">Company Name</label>
                            <input
                              type="text"
                              formControlName="companyName"
                              class="form-control"
                            />
                          </div>
                        </div>
                    
                        <div class="col-md-6 col-lg-3">
                          <div class="input-block">
                            <label for="position" class="focus-label">Position</label>
                            <select
                              formControlName="position"
                              placeholder="Select"
                              class="form-control form-select"
                            >
                              <option *ngFor="let level of skillLevels" [value]="level">
                                {{ level }}
                              </option>
                            </select>
                          </div>
                        </div>
                    
                        <div class="col-md-6 col-lg-3">
                          <div class="input-block">
                            <label for="start-date" class="focus-label">Start Date</label>
                            <div class="cal-icon">
                              <input
                                type="text"
                                formControlName="startDate"
                                class="form-control datetimepicker"
                                bsDatepicker
                                placeholder="Choose"
                                [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' }"
                              />
                            </div>
                          </div>
                        </div>
                    
                        <div class="col-md-6 col-lg-3">
                          <div class="input-block">
                            <label for="end-date" class="focus-label">End Date</label>
                            <div class="cal-icon">
                              <input
                                type="text"
                                formControlName="endDate"
                                class="form-control datetimepicker"
                                bsDatepicker
                                placeholder="Choose"
                                [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' }"
                              />
                            </div>
                            <div class="new-addd">
                              <a
                                *ngIf="i === experiencesArray.length - 1"
                                class="add-new"
                                (click)="addExperience()"
                                tabindex="0"
                                ><i class="feather icon-plus-circle me-1"></i> Add New</a
                              >
                              <a
                                *ngIf="experiencesArray.length > 1"
                                class="remove_row"
                                (click)="removeExperience(i)"
                                >Remove</a
                              >
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    

                    <div class="row" formArrayName="languages">
                      <div class="col-md-12">
                        <h4>Language</h4>
                      </div>
                      <div class="col-md-6" *ngFor="let language of languagesArray.controls; let i = index" [formGroupName]="i">
                        <div class="input-block">
                          <label for="language" class="form-label">Language</label>
                          <input type="text" class="form-control" formControlName="name" />
                        </div>
                      </div>
                      <div class="col-md-6" *ngFor="let language of languagesArray.controls; let i = index" [formGroupName]="i">
                        <div class="input-block">
                          <label for="level" class="focus-label">Level</label>
                          <select formControlName="level" class="form-control form-select">
                            <option *ngFor="let level of selectedList6" [value]="level.value">
                              {{ level.value }}
                            </option>
                          </select>
                          <div class="new-addd">
                            <a *ngIf="i === languagesArray.length - 1" class="add-new" (click)="addLanguage()" tabindex="0">
                              <i class="feather icon-plus-circle me-1"></i> Add New
                            </a>
                            <a *ngIf="languagesArray.length > 1" class="remove_row" (click)="removeLanguage(i)">
                              Remove
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                </form>
              </div>
              <div class="text-center">
                <input
                  class="btn btn-prev prev_btn btn-back"
                  name="next"
                  type="button"
                  value="Back"
                  (click)="selectedFieldSet[0] = 1"
                />
                <input
                  class="btn next_btn btn-primary btn-get btn-next"
                  name="next"
                  type="submit"
                  value="Save"
                  (click)="create(form)"
                />
              </div>
            </div>
            <!-- /Skills & Experience -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
